import"./utils.DE1O8Krf.js";import{a as D,b as R}from"./api.u-GyJUGh.js";import{s as V}from"./gift.IGWJdFdP.js";import{i as F}from"./pro-modal.Deig-JMx.js";const z="modulepreload",J=function(e){return"/"+e},N={},k=function(n,t,o){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),u=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));s=Promise.allSettled(t.map(g=>{if(g=J(g),g in N)return;N[g]=!0;const a=g.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${c}`))return;const f=document.createElement("link");if(f.rel=a?"stylesheet":z,a||(f.as="script"),f.crossOrigin="",f.href=g,u&&f.setAttribute("nonce",u),document.head.appendChild(f),a)return new Promise((v,E)=>{f.addEventListener("load",v),f.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(r){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=r,window.dispatchEvent(u),!u.defaultPrevented)throw r}return s.then(r=>{for(const u of r||[])u.status==="rejected"&&l(u.reason);return n().catch(l)})};function H(e,n,t={}){var u,g;if(!e||!n)return;let o=(n.photos||[]).filter(a=>a&&a.trim()!=="");o.length===0&&(o=["/img/photo.svg"]);const s=o[0];let l;if(s.startsWith("http")||s.startsWith("data:"))l=s;else if(s.startsWith("/data/img/"))l=s;else if(s==="/img/photo.svg")l=s;else{const a=s.split("/").pop();l=`/data/img/${n.userId||n.id}/${a}`}e.style.position="relative",e.style.backgroundImage=`url(${l})`,e.style.backgroundSize="cover",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat";const r=(u=e.parentElement)==null?void 0:u.querySelector(".paginator");if(r&&(o.length<=1?r.style.display="none":(r.style.display="flex",T(r,o.length,0))),n.badge&&t.showBadges!==!1){const a=e.querySelector(".badge-wrapper");if(a){a.style.display="flex";const c=a.querySelector(".badge-image");if(c){const f=window.location.hostname==="localhost"?`/labels/${n.badge}.svg`:`sta-black-dim.waw.amverum.cloud/labels/${n.badge}.svg`;c.src=f}}else console.warn("[card.js] badge-wrapper –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–∞—Ä—Ç–æ—á–∫–µ")}else{const a=e.querySelector(".badge-wrapper");a&&(console.log("[card.js] –°–∫—Ä—ã–≤–∞–µ–º badge-wrapper"),a.style.display="none")}if((n.userId||n.id)&&U(e,n.userId||n.id),t.showFooter&&!t.isOwnProfile&&Q(e.parentElement,n),e.dataset.photos=JSON.stringify(o),e.dataset.photoIndex="0",e.dataset.userId=n.userId||n.id,e.innerHTML=`
    <div class="gradient-card"></div>
    <div class="candidate-goals"></div>
    <div class="user-info">
      ${n.badge?`<div class="badge-wrapper"><img src="/labels/${n.badge}.svg" class="badge-image"></div>`:""}
      <div class="name-age-container">
        <span class="user-name">${n.name||""}</span>
        ${!((g=window.currentUser)!=null&&g.hideAge)&&n.age?`<span class="user-age">${n.age} –ª–µ—Ç</span>`:""}
      </div>
      <p class="user-bio">${n.bio||""}</p>
      ${o.length>1?'<div class="paginator"></div>':""}
    </div>
    <div class="card-badge badge-like">üòç</div>
    <div class="card-badge badge-nope">üö´</div>
    <div class="card-badge badge-match">‚ù§Ô∏è‚Äçüî•</div>
    ${t.showDeleteMatchBtn?'<button class="delete-match-btn">–£–¥–∞–ª–∏—Ç—å –º—ç—Ç—á</button>':""}
  `,(n.userId||n.id)&&U(e,n.userId||n.id),o.length>1){const a=e.querySelector(".paginator");a.style.display="flex",T(a,o.length,parseInt(e.dataset.photoIndex||"0",10))}if(e.onclick=()=>{const a=JSON.parse(e.dataset.photos||"[]");if(a.length<2)return;let c=parseInt(e.dataset.photoIndex||"0",10);c=(c+1)%a.length,e.dataset.photoIndex=c;const f=a[c];let v;if(f.startsWith("http")||f.startsWith("data:"))v=f;else if(f.startsWith("/data/img/"))v=f;else if(f==="/img/photo.svg")v=f;else{const S=f.split("/").pop();v=`/data/img/${n.userId||n.id}/${S}`}e.style.backgroundImage=`url('${v}')`;const E=e.querySelector(".paginator");E&&T(E,a.length,c)},t.showDeleteMatchBtn){const a=e.querySelector(".delete-match-btn");a&&typeof t.onDeleteMatch=="function"&&a.addEventListener("click",c=>{c.stopPropagation(),t.onDeleteMatch(n)})}}function U(e,n){if(!e||!n)return;const t=e.querySelector(".candidate-goals");t&&(t.classList.add("left"),t.innerHTML="",D(n).then(o=>{o&&o.success&&Array.isArray(o.goals)&&o.goals.length>0?(t.innerHTML="",o.goals.forEach(s=>{const l=document.createElement("div");l.className="goal-tag",l.textContent=s,t.appendChild(l)})):t.innerHTML=""}).catch(o=>{console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–ª–µ–π –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:",o),t.innerHTML=""}))}function T(e,n,t){if(e){e.innerHTML="";for(let o=0;o<n;o++){const s=document.createElement("div");s.className=o===t?"pag_active":"pag",e.appendChild(s)}}}const K=Object.freeze(Object.defineProperty({__proto__:null,fillCard:H,renderCardGoals:U,renderCardPaginator:T},Symbol.toStringTag,{value:"Module"}));let O;k(()=>import("./user-actions.DbKfUyWR.js"),[]).then(e=>{e.loadUserData,O=e.handlePhotoAddition}).catch(e=>{console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å user-actions:",e)});let X=[];window.swipeHistory=X;window.currentIndex=0;function W(){window.showCandidateFromSwipe=W;const e=document.getElementById("singleCard");if(window.currentUser.needPhoto===1){console.log('[showCandidate] needPhoto=1, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ"'),e.style.backgroundImage="none",e.style.backgroundColor="#fff";const t=window.currentUser.photoErrorReason?`<div class='photo-error-reason'>${window.currentUser.photoErrorReason}</div>`:"";e.innerHTML=`
      <div class="no-users invite-wrapper">
        ${t}
        <h3>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ 1-3 —Ñ–æ—Ç–æ —Å –ª–∏—Ü–æ–º, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—ã.</h3>
        <button id="add-photo-swipe-btn" class="invite-button">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
      </div>
    `,e.style.boxShadow="none",document.querySelectorAll(".back-cnd-btn, .superlike_d, .like_d, .dislike_d").forEach(s=>s.style.display="none");const o=document.getElementById("add-photo-swipe-btn");if(o){const s=o.cloneNode(!0);o.parentNode.replaceChild(s,o),s.addEventListener("click",function(){O.call(s)}),console.log("[showCandidate] –ö–Ω–æ–ø–∫–∞ –Ω–∞–π–¥–µ–Ω–∞, –Ω–∞–≤–µ—à–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ handlePhotoAddition (import)")}return}if(!window.candidates||window.candidates.length===0||window.currentIndex>=window.candidates.length){const t=e.cloneNode(!1);e.parentNode.replaceChild(t,e),t.style.backgroundImage="none",t.style.backgroundColor="#fff",t.innerHTML=`
      <div class="no-users invite-wrapper">
        <h3>–ù–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <button id="invite-button" class="invite-button">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
      </div>
    `,t.style.boxShadow="none",t.className="card",document.querySelectorAll(".back-cnd-btn, .superlike_d, .like_d, .dislike_d").forEach(o=>o.style.display="none"),t.querySelector("#invite-button").addEventListener("click",window.shareInvite);return}const n=window.candidates[window.currentIndex];H(e,{...n}),e.classList.remove("show-match","returning"),e.classList.add("card-appear"),e.addEventListener("animationend",function t(){e.classList.remove("card-appear"),e.removeEventListener("animationend",t)}),document.querySelectorAll(".like_d, .dislike_d").forEach(t=>t.style.display=window.currentUser.needPhoto?"none":"flex"),window.currentUser.is_pro&&!window.currentUser.needPhoto&&document.querySelectorAll(".back-cnd-btn, .superlike_d").forEach(t=>t.style.display="flex")}function Y(){const e="–ü—Ä–∏–≤–µ—Ç! –ù–∞—à—ë–ª —É–¥–æ–±–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤ –º–µ–∂–¥—É —Å–æ—Å–µ–¥—è–º–∏ –Ω–∞—à–µ–≥–æ –ñ–ö.: https://t.me/SeligerTinderApp_bot/sta";navigator.share?navigator.share({text:e}).catch(n=>{n&&n.name!=="AbortError"&&alert("–û—à–∏–±–∫–∞ —à–∞—Ä–∏–Ω–≥–∞: "+n.message)}):navigator.clipboard.writeText(e).then(()=>alert("–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞")).catch(()=>alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç"))}window.shareInvite=Y;function $(e){const n=`https://t.me/${e}`;window.tg&&window.tg.openTelegramLink?window.tg.openTelegramLink(n):window.open(n,"_blank")}window.showCandidate=W;console.log("profile.js loaded");console.log("üîç [profile.js] –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ profile.js");let B,q;k(()=>import("./user-actions.DbKfUyWR.js"),[]).then(e=>{B=e.loadUserData,q=e.handlePhotoAddition}).catch(e=>{console.warn("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å user-actions:",e)});function M(){const e=window.currentUser;if(!e){console.error("currentUser –Ω–µ –Ω–∞–π–¥–µ–Ω");return}const n=document.getElementById("profileCard"),t=document.querySelector("#screen-profile .user-info"),o=document.querySelector("#screen-profile .name-age-container .user-name"),s=document.querySelector("#screen-profile .name-age-container .user-age"),l=document.querySelector("#screen-profile .user-info .user-bio");let r=document.querySelector("#screen-profile .user-info .paginator");if(e.needPhoto===1&&n){n.style.backgroundImage="none",n.style.backgroundColor="#fff",n.innerHTML=`
      <div class="no-users invite-wrapper">
        <h3>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ 1-3 —Ñ–æ—Ç–æ —Å –ª–∏—Ü–æ–º, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—ã.</h3>
        <button id="add-photo-profile-btn" class="invite-button">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
      </div>
    `,t&&(t.style.display="none"),o&&(o.style.display="none"),s&&(s.style.display="none"),l&&(l.style.display="none"),r&&(r.style.display="none");const u=document.getElementById("add-photo-profile-btn");if(u){const g=u.cloneNode(!0);u.parentNode.replaceChild(g,u),g.addEventListener("click",function(){q.call(g)})}return}else t&&(t.style.display=""),o&&(o.style.display=""),s&&(s.style.display=""),l&&(l.style.display=""),r&&(r.style.display="");if(n&&t){const u=t.querySelector(".badge-wrapper");u&&u.remove();const g=document.querySelector("#screen-profile .profile-container");if(g){const y=g.querySelector(".profile-footer");y&&y.remove()}if(o&&(o.textContent=e.name||"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"),s&&(!e.hideAge&&e.age?(s.textContent=`${e.age} –ª–µ—Ç`,s.style.display=""):s.style.display="none"),l&&(l.textContent=e.bio||""),e.badge&&e.badge.trim()!==""){const y=document.createElement("div");y.className="badge-wrapper",y.innerHTML=`<img src="/labels/${e.badge}.svg" alt="Badge" class="badge-image">`,t.prepend(y)}let a=e.photos||[];a.length===0&&(a=["/img/photo.svg"]);const c=a[0],f=c.startsWith("data:")?c:`${c}?cb=${Date.now()}`;n.style.backgroundImage=`url('${f}')`,n.style.backgroundSize="cover",n.style.backgroundPosition="center",n.style.backgroundRepeat="no-repeat";let v=n.querySelector(".gradient-card");v||(v=document.createElement("div"),v.className="gradient-card",n.appendChild(v)),e.photos&&e.photos.length>1?(!r&&t&&(r=document.createElement("div"),r.className="paginator",t.appendChild(r)),r&&k(async()=>{const{renderPaginator:y}=await import("./utils.DE1O8Krf.js");return{renderPaginator:y}},[]).then(({renderPaginator:y})=>{y(r,e.photos.length,0)})):r&&r.remove();let E=0;n.onclick=()=>{if(a.length<2)return;E=(E+1)%a.length;const y=a[E],A=y.startsWith("data:")?y:`${y}?cb=${Date.now()}`;n.style.backgroundImage=`url('${A}')`,r&&k(async()=>{const{renderPaginator:I}=await import("./utils.DE1O8Krf.js");return{renderPaginator:I}},[]).then(({renderPaginator:I})=>{I(r,a.length,E)})};let S=n.querySelector(".candidate-goals");S&&S.remove();let L=n.querySelector(".candidate-goals");L||(L=document.createElement("div"),L.className="candidate-goals left",n.appendChild(L)),k(async()=>{const{renderCardGoals:y}=await Promise.resolve().then(()=>K);return{renderCardGoals:y}},void 0).then(({renderCardGoals:y})=>{y(n,e.userId||e.id)})}}function G(){const e=window.currentUser;typeof window.handlePhotoAddition!="function"&&typeof q=="function"&&(window.handlePhotoAddition=q),typeof window.loadUserData!="function"&&typeof B=="function"&&(window.loadUserData=B);let n=null;const t=document.getElementById("edit-bio-input");if(t){let p=function(){const i=document.querySelector(".edit-photo-carousel"),m=document.querySelector(".edit-age-container"),w=document.querySelector(".goal-container");i&&(i.style.display="flex"),m&&(m.style.display="flex"),w&&(w.style.display="block"),n&&!document.body.contains(n)&&((document.querySelector(".profile-edit-content")||document.body).appendChild(n),n=null),t.style.position="",t.style.top="",t.style.left="",t.style.transform="",t.style.zIndex="",t.style.width="",t.style.maxWidth="",t.style.margin="",t.style.background="",t.style.paddingBottom=""};t.value=e.bio||"",t.style.paddingLeft="20px",t.style.paddingRight="20px",t.style.color="#202022",t.addEventListener("input",function(){t.style.color="#202022"}),t.addEventListener("focus",function(){const i=document.querySelector(".edit-photo-carousel"),m=document.querySelector(".edit-age-container"),w=document.querySelector(".goal-container"),d=document.querySelector(".edit-buttons-container");function b(){i&&(i.style.display="none"),m&&(m.style.display="none"),w&&(w.style.display="none"),d&&d.parentNode&&(n=d,d.parentNode.removeChild(d)),t.style.position="fixed",t.style.top="50%",t.style.left="0",t.style.right="0",t.style.transform="translateY(-50%)",t.style.zIndex="2000",t.style.width="100%",t.style.maxWidth="400px",t.style.margin="0 auto",t.style.background="#fff",t.style.paddingBottom="env(safe-area-inset-bottom, 30px)"}let C=0;function h(){b(),C++,C<5?setTimeout(h,60):requestAnimationFrame(b)}h()}),t.addEventListener("keydown",function(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),p(),t.blur())}),document.addEventListener("click",function(i){i.target!==t&&t.style.position==="fixed"&&p()})}const o=document.getElementById("edit-age-input");if(o){let p=function(){n&&!document.body.contains(n)&&((document.querySelector(".profile-edit-content")||document.body).appendChild(n),n=null)};o.value=e.age||"",o.style.color="#202022",o.addEventListener("focus",function(){const i=document.querySelector(".edit-buttons-container");i&&i.parentNode&&(n=i,i.parentNode.removeChild(i))}),o.addEventListener("keydown",function(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),p(),o.blur())}),document.addEventListener("click",function(i){i.target!==o&&n&&p()})}const s=document.getElementById("age-toggle-icon"),l=document.querySelector(".age-label");s&&o&&(e.hideAge?(s.classList.remove("active"),s.style.backgroundImage="url('/img/eye_close.svg')",o.disabled=!0,o.setAttribute("disabled","disabled"),o.style.filter="grayscale(100%)",l&&(l.style.color="#999")):(s.classList.add("active"),s.style.backgroundImage="url('/img/eye_open.svg')",o.disabled=!1,o.removeAttribute("disabled"),o.style.filter="none",l&&(l.style.color="")),s.onclick=()=>{if(console.log("[AGE TOGGLE] –ö–ª–∏–∫! id:",s.id,"class:",s.className,"currentUser.hideAge:",e.hideAge,"ageInput.disabled:",o.disabled,"ageLabel.color:",l&&l.style.color),s.classList.toggle("active"))s.style.backgroundImage="url('/img/eye_open.svg')",o.disabled=!1,o.removeAttribute("disabled"),setTimeout(()=>{o.disabled&&o.removeAttribute("disabled")},100),o.style.filter="none",l&&(l.style.color=""),e.hideAge=!1,console.log("[AGE TOGGLE][DEBUG] –ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è: disabled=",o.disabled,"hasAttr=",o.hasAttribute("disabled"));else{s.style.backgroundImage="url('/img/eye_close.svg')",o.disabled=!0,o.setAttribute("disabled","disabled"),setTimeout(()=>{o.disabled||o.setAttribute("disabled","disabled")},100);let i=0;const m=setInterval(()=>{i++,o.disabled||(o.disabled=!0,o.setAttribute("disabled","disabled"),console.log("[AGE TOGGLE][PATCH] –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å—Ç–∞–≤–∏–ª disabled!")),o.hasAttribute("disabled")||(o.setAttribute("disabled","disabled"),console.log("[AGE TOGGLE][PATCH] –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å—Ç–∞–≤–∏–ª –∞—Ç—Ä–∏–±—É—Ç disabled!")),i>10&&clearInterval(m)},100);o.style.filter="grayscale(100%)",l&&(l.style.color="#999"),e.hideAge=!0,console.log("[AGE TOGGLE][DEBUG] –ü–æ—Å–ª–µ —Å–∫—Ä—ã—Ç–∏—è: disabled=",o.disabled,"hasAttr=",o.hasAttribute("disabled"))}console.log("[AGE TOGGLE] –ü–æ—Å–ª–µ: currentUser.hideAge:",e.hideAge,"ageInput.disabled:",o.disabled,"ageLabel.color:",l&&l.style.color)});const r=document.querySelector(".edit-photo-carousel");if(r){r.innerHTML="";const p=document.createElement("div");p.className="ghost-card",setTimeout(()=>{const d=r.querySelector(".edit-photo-card");p.style.width=d?d.offsetWidth/2+"px":"48px"},0),r.appendChild(p);const i=e.photos||[],m=Math.min(i.length,3);for(let d=0;d<m;d++){let b=document.createElement("div");b.className="edit-photo-card has-photo",b.innerHTML="";const C=i[d],h=C.startsWith("data:")?C:`${C}?cb=${Date.now()}`;b.style.backgroundImage=`url('${h}')`;const P=document.createElement("div");P.className="main-badge",d===0?P.innerHTML='<img src="/img/main_on.svg" alt="–ì–ª–∞–≤–Ω–∞—è"> <span>–ì–ª–∞–≤–Ω–∞—è</span>':(P.innerHTML='<img src="/img/main_off.svg" alt="–°–¥–µ–ª–∞—Ç—å –≥–ª–∞–≤–Ω–æ–π"> <span>–°–¥–µ–ª–∞—Ç—å –≥–ª–∞–≤–Ω–æ–π</span>',P.onclick=()=>{d>0&&([i[0],i[d]]=[i[d],i[0]],G())}),b.appendChild(P);const _=document.createElement("div");_.className="delete-photo-btn",_.innerHTML='<img src="/img/dislike.svg" alt="–£–¥–∞–ª–∏—Ç—å">',_.onclick=j=>{j.stopPropagation(),i.splice(d,1),G()},b.appendChild(_),r.appendChild(b)}if(m<3)for(let d=0;d<3-m;d++){let b=document.createElement("div");b.className="edit-photo-card add-photo",b.innerHTML="",b.onclick=function(){window.handlePhotoAddition?window.handlePhotoAddition.call(this):alert("–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")},r.appendChild(b)}const w=document.createElement("div");w.className="ghost-card",setTimeout(()=>{const d=r.querySelector(".edit-photo-card");w.style.width=d?d.offsetWidth/2+"px":"48px"},0),r.appendChild(w)}const u=document.querySelector(".goal-container");u&&u.remove();const g=document.createElement("div");g.className="goal-container";const a=document.createElement("label");a.className="goal-label",a.textContent="–¶–µ–ª—å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞:",g.appendChild(a);const c=document.createElement("div");c.className="goal-list",c.style.display="flex",c.style.overflowX="auto",c.style.gap="12px",c.style.padding="8px 0";const f=document.createElement("div");f.className="ghost-card",c.appendChild(f);const v=["–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è","–†–æ–º–∞–Ω—Ç–∏–∫–∞ –∏ –ª—é–±–æ–≤—å","–î—Ä—É–∂–±–∞ –∏ –æ–±—â–µ–Ω–∏–µ","–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º—å–∏","–í—Å—Ç—Ä–µ—á–∏ –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤"],E=new Set(e.goals||[]);v.forEach(p=>{const i=document.createElement("div");if(i.className="goal-item",i.innerHTML=`<span>${p}</span><img src="/img/main_off.svg" class="goal-icon" />`,i.style.scrollSnapAlign="center",E.has(p)){i.classList.add("selected");const m=i.querySelector("img.goal-icon");m&&(m.src="/img/main_on.svg")}i.addEventListener("click",()=>{const m=c.querySelectorAll(".goal-item.selected").length;if(!i.classList.contains("selected")&&m>=3){window.showToast("–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 3 —Ü–µ–ª–µ–π");return}i.classList.toggle("selected");const w=i.querySelector("img.goal-icon");w.src=i.classList.contains("selected")?"/img/main_on.svg":"/img/main_off.svg"}),c.appendChild(i)});const S=document.createElement("div");S.className="ghost-card",c.appendChild(S),g.appendChild(c);const L=document.querySelector(".profile-edit-content"),y=document.getElementById("edit-bio-input");L&&y?L.insertBefore(g,y):console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞ —Ü–µ–ª–µ–π: .profile-edit-content –∏–ª–∏ #edit-bio-input");const A=document.getElementById("save-goals-btn");A&&(A.onclick=async()=>{const p=Array.from(document.querySelectorAll(".goal-item.selected")).map(i=>i.textContent.trim());try{const m=await(await window.updateProfile({userId:window.currentUser.userId,goals:p})).json();if(!m||!m.success){const w=m?m.error:"–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω";window.showToast&&window.showToast("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–µ–ª–µ–π: "+w)}else await Z(),window.showToast&&window.showToast("–¶–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")}catch{window.showToast&&window.showToast("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ü–µ–ª–µ–π")}});const I=document.getElementById("cancel-edit-button")||document.getElementById("edit-cancel-button")||document.querySelector(".edit-cancel-button"),x=document.getElementById("save-edit-button")||document.getElementById("edit-save-button")||document.querySelector(".edit-save-button");if(I){const p=I.cloneNode(!0);I.parentNode.replaceChild(p,I),p.style.pointerEvents="auto",p.addEventListener("click",()=>{console.log("‚ñ∂ –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ '–û—Ç–º–µ–Ω–∞'"),console.log("üîç –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–∑–≤–∞—Ç—å exitProfileEditMode (–û—Ç–º–µ–Ω–∞)..."),window.exitProfileEditMode?(console.log("‚úÖ –§—É–Ω–∫—Ü–∏—è exitProfileEditMode –Ω–∞–π–¥–µ–Ω–∞, –≤—ã–∑—ã–≤–∞–µ–º..."),window.exitProfileEditMode()):(console.error("‚ùå –§—É–Ω–∫—Ü–∏—è exitProfileEditMode –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"),console.log("üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:",Object.keys(window).filter(i=>i.includes("exit"))),showScreen("screen-profile"))})}if(x){const p=x.cloneNode(!0);x.parentNode.replaceChild(p,x),p.style.pointerEvents="auto",p.addEventListener("click",()=>{console.log("‚ñ∂ –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ '–ì–æ—Ç–æ–≤–æ'");const i=document.getElementById("edit-bio-input"),m=document.getElementById("edit-age-input"),w=i.value.trim();let d=null;if(!e.hideAge&&(d=parseInt(m.value,10),isNaN(d)||d<1||d>99)){alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç (–æ—Ç 1 –¥–æ 99)");return}const b=Array.from(document.querySelectorAll(".goal-item.selected")).map(h=>h.textContent.trim());console.log("saveProfile: selectedGoals",b);const C={userId:e.userId,bio:w,age:d,photos:e.photos,goals:b};fetch(`${window.API_URL}/updateProfile`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then(h=>h.json()).then(h=>{if(console.log("updateProfile result:",h),!h.success){alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è: "+h.error);return}return e.bio=w,e.age=d,fetch(`${window.API_URL}/goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.userId,goals:b})})}).then(h=>{if(h)return h.json()}).then(h=>{if(h){if(console.log("updateGoals result:",h),!h.success){alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–µ–ª–µ–π: "+h.error);return}console.log("üîç –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–∑–≤–∞—Ç—å exitProfileEditMode..."),window.exitProfileEditMode?(console.log("‚úÖ –§—É–Ω–∫—Ü–∏—è exitProfileEditMode –Ω–∞–π–¥–µ–Ω–∞, –≤—ã–∑—ã–≤–∞–µ–º..."),window.exitProfileEditMode()):(console.error("‚ùå –§—É–Ω–∫—Ü–∏—è exitProfileEditMode –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"),console.log("üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:",Object.keys(window).filter(P=>P.includes("exit"))),showScreen("screen-profile"))}}).catch(h=>{console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ —Ü–µ–ª–µ–π:",h),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ —Ü–µ–ª–µ–π")})})}}function Q(e,n){var g,a;(g=n.querySelector(".profile-footer"))==null||g.remove();const t=String(((a=window.currentUser)==null?void 0:a.userId)||"").trim().toLowerCase(),o=String(e.userId||e.id||"").trim().toLowerCase();if(!o||o===t)return;const s=document.createElement("div");if(s.className="profile-footer",(e.userId||e.id||"").startsWith("VALID_")&&e.username&&e.username.trim())s.innerHTML=`
      <button id="candidate-write-btn" class="profile-button">–ù–∞–ø–∏—Å–∞—Ç—å</button>
      <button id="candidate-gift-btn" class="profile-button">–ü–æ–¥–∞—Ä–æ–∫</button>
    `;else{const c=e.pushSent?"–í—ã –ø–æ–º–∞—Ö–∞–ª–∏":"–ü–æ–º–∞—Ö–∞—Ç—å",f=e.pushSent?"disabled":"";s.innerHTML=`
      <button id="candidate-wave-btn" class="profile-button" ${f}>${c}</button>
      <button id="candidate-gift-btn" class="profile-button">–ü–æ–¥–∞—Ä–æ–∫</button>
    `}n.appendChild(s);const l=s.querySelector("#candidate-wave-btn");l&&l.addEventListener("click",async()=>{l.disabled=!0,l.textContent="–í—ã –ø–æ–º–∞—Ö–∞–ª–∏",(await R({senderId:window.currentUser.userId,senderUsername:window.currentUser.username||window.currentUser.name,receiverId:e.userId||e.id})).success||(l.textContent="–ü–æ–º–∞—Ö–∞—Ç—å üëã",l.disabled=!1)});const r=s.querySelector("#candidate-write-btn");r&&r.addEventListener("click",()=>{$&&$(e.username)});const u=s.querySelector("#candidate-gift-btn");u&&u.addEventListener("click",()=>{window.selectedCandidateId=e.userId||e.id,V()})}document.addEventListener("DOMContentLoaded",()=>{F()});async function Z(){var e;try{const n=(e=window.currentUser)==null?void 0:e.userId;if(!n)return;const t=await window.getUser(n);t&&t.success&&t.user&&(window.currentUser=t.user,typeof M=="function"&&M())}catch(n){console.error("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:",n)}}export{k as _,W as a,Y as b,G as i,$ as o,Q as r,X as s,M as u};
