# üîí –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ SSRF –∑–∞—â–∏—Ç–∞
- **–§–∞–π–ª**: `python_backend/middleware/security.py`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `urllib.parse` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö IP –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (10.x.x.x, 172.16-31.x.x, 192.168.x.x)
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∞–¥—Ä–µ—Å–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã)
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ metadata endpoints (AWS, GCP, Azure)

### 2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ CSP –ø–æ–ª–∏—Ç–∏–∫–∞
- **–§–∞–π–ª**: `python_backend/main.py`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
  - –î–æ–±–∞–≤–ª–µ–Ω `frame-ancestors 'none'` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç clickjacking
  - –î–æ–±–∞–≤–ª–µ–Ω `blob:` –¥–ª—è img-src (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π)
  - –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: `unsafe-inline` –∏ `unsafe-eval` –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è Telegram Web App

### 3. ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è frontend
- **–§–∞–π–ª**: `frontend/src/utils/security.js`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `escapeHtml()` - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML —Å–∏–º–≤–æ–ª–æ–≤
  - `setSafeText()` - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ textContent
  - `createSafeElement()` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  - `validateName()`, `validateBio()`, `validateAge()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 4. ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–§–∞–π–ª**: `python_backend/middleware/logging.py`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `log_suspicious_activity()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
  - `check_rate_limit()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ rate limit –¥–ª—è IP
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ IP –∞–¥—Ä–µ—Å–∞–º

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –≤–æ frontend
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `frontend/src/utils/security.js`:
- `frontend/src/main.js` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `escapeHtml()` –¥–ª—è name, bio, age
- `frontend/src/match.js` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `escapeHtml()` –¥–ª—è name
- `frontend/src/card.js` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `escapeHtml()` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `frontend/src/profile.js` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `escapeHtml()` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å rate limiting –∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
–î–æ–±–∞–≤–∏—Ç—å rate limiting –∫ —Å–ª–µ–¥—É—é—â–∏–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º:
- `/api/like` - 30/–º–∏–Ω—É—Ç—É
- `/api/dislike` - 30/–º–∏–Ω—É—Ç—É
- `/api/superlike` - 10/–º–∏–Ω—É—Ç—É
- `/api/join` - 10/–º–∏–Ω—É—Ç—É (—É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ)
- `/api/photos/upload` - 20/–º–∏–Ω—É—Ç—É (—É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ)

### 3. –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ –¥–ª—è email (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π

### 4. –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Ñ–æ—Ä–º
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã –≤ POST/PUT/DELETE –∑–∞–ø—Ä–æ—Å–∞—Ö

### 5. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `middleware/logging.py` –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–≤–º–µ—Å—Ç–æ in-memory)

### 6. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ rate limit –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö admin –¥–µ–π—Å—Ç–≤–∏–π

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ:
- SQL Injection (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- Path Traversal (–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–µ–π)
- File Upload (–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞, —Ä–∞–∑–º–µ—Ä–∞, —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)
- SSRF (—É–ª—É—á—à–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞)
- XSS (–±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ CSP, –Ω—É–∂–Ω–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–æ frontend)
- Rate Limiting (–≥–ª–æ–±–∞–ª—å–Ω—ã–π, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º)
- Security Headers (CSP, HSTS, X-Frame-Options –∏ –¥—Ä.)
- Admin Authorization (Telegram ID + Bearer Token)

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- XSS —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–æ frontend (—Å–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å, –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å)
- Rate limiting –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- CSRF –∑–∞—â–∏—Ç–∞ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Å–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å, –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å)

