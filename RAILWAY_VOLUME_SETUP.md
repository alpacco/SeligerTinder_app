# Настройка постоянного хранилища (Volume) в Railway

## Что такое Volume?

Volume в Railway - это постоянное хранилище данных, которое сохраняется между перезапусками контейнера. Это необходимо для:
- Изображений пользователей (`/data/img`)
- Логов (`/data/log`)
- Изображений подарков (`/data/giftimg`)

## Пошаговая инструкция

### 1. Создание Volume

1. Откройте ваш проект в Railway Dashboard
2. Перейдите в раздел **Settings** вашего сервиса
3. Найдите секцию **Volumes** (или **Storage**)
4. Нажмите **"Add Volume"** или **"Create Volume"**

### 2. Настройка Volume

При создании volume укажите:

- **Volume Name**: `data-volume` (или любое другое имя)
- **Mount Path**: `/data`
- **Size**: `5 GB` (или больше, в зависимости от ваших потребностей)

### 3. Подключение Volume к сервису

1. После создания volume, он должен автоматически подключиться к вашему сервису
2. Убедитесь, что **Mount Path** установлен в `/data`
3. Это означает, что все данные в `/data` будут сохраняться между перезапусками

### 4. Проверка

После настройки volume:

1. Railway автоматически перезапустит ваш сервис
2. Проверьте логи - должны появиться сообщения:
   ```
   ✅ Папка уже существует: /data/img
   ✅ Папка уже существует: /data/log
   ✅ Папка уже существует: /data/giftimg
   ```

### 5. Важные замечания

- **Mount Path должен быть `/data`** - это путь, который используется в коде
- Volume создается в том же регионе, что и ваш сервис
- Данные в volume сохраняются даже при удалении и пересоздании сервиса
- Volume можно увеличить позже (кнопка "Grow" в настройках)

## Альтернативный способ (через railway.json)

Если Railway поддерживает конфигурацию через файл, можно добавить в `railway.json`:

```json
{
  "deploy": {
    "volumes": [
      {
        "name": "data-volume",
        "mountPath": "/data",
        "size": "5GB"
      }
    ]
  }
}
```

## Проверка работы

После настройки volume:

1. Загрузите тестовое изображение через приложение
2. Перезапустите сервис в Railway
3. Проверьте, что изображение все еще доступно после перезапуска

## Увеличение размера Volume

Если volume заполнился:

1. Откройте настройки volume в Railway Dashboard
2. В секции **Size** нажмите кнопку **"Grow"**
3. Выберите новый размер
4. Railway автоматически увеличит volume

## Важно

- **Не храните в volume**: временные файлы, кэш, node_modules
- **Храните в volume**: изображения пользователей, логи, загруженные файлы
- Volume привязан к региону - при смене региона нужно создать новый volume

